<!DOCTYPE html>

<!-- 
CompEpi Survey
Tony Andrys
--> 

<html ng-app="compEpiSurvey">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <title></title>

    <link href="lib/ionic/css/ionic.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

    <!-- Temporary addition of D3 graph CSS style inline. FIXME -->
    <style>
      #chart div {
        font: 10px sans-serif;
        background-color: steelblue;
        text-align: right;
        padding: 3px;
        margin: 1px;
        color: white;
      }
    </style>


    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <!-- ionic/angularjs js -->
    <script src="lib/ionic/js/ionic.bundle.js"></script>

    <!-- cordova script (this will be a 404 during development) -->
    <script src="cordova.js"></script>

    <!-- app js includes -->
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript" src="js/controllers.js"></script>
    <script type="text/javascript" src="js/services.js"></script>

    <!-- include angular-local-storage module -->
    <script type="text/javascript" src="js/angular-local-storage.js"></script>

    <!-- include D3 and jquery -->
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js" charset="utf-8"></script>

  </head>
  <body>

    <!-- Setup and configure the navigation bar -->
    <ion-nav-bar class="nav-title-slide-ios7 bar-positive">
      <ion-nav-back-button class="button-icon ion-arrow-left-c">
      </ion-nav-back-button>
    </ion-nav-bar>
   
    <!-- Templates from /www/templates are rendered in this ion-nav-view -->
    <ion-nav-view animation="slide-left-right"></ion-nav-view>
    
    <!-- Chart Generation Javscript -->
    <!-- FIXME: Move to an external script, inline javascript is ugly -->
    <script type="text/javascript">

    // When the Generate button is clicked, fire the chart generation function
    $(document).on('click', '#generateChartButton', function() {

        console.log("Generating chart...");

        // Clear the #chart hierarchy before adding to it
        $("#chart").empty(); 

        // Get the inputted data and split on commas to form an array
        var input = $("#inputDataField").val();
        var data = input.split(",").map(function(x) {
          // Convert substrings to integers
          return parseInt(x, 10); 
        });

        // Set graph params
        var x = d3.scale.linear()
            .domain([0, d3.max(data)])
            .range([0, 420]);

        // Generate the chart one element at a time and add to <div id=chart> tag in the body.
        d3.select("#chart")

          // Separate into divs
          .selectAll("div")
            .data(data)
          .enter().append("div")

            // Define the style of this bar
            .style("width", function(d) { return x(d) + "px"; })
            .text(function(d) { return d; });

      });
</script>

  </body>
</html>
